CREATE TABLE BRANCH (
    BNAME VARCHAR(25) PRIMARY KEY,
    CITY VARCHAR(25)
);

CREATE TABLE CUSTOMERS (
    CNAME VARCHAR(25) PRIMARY KEY,
    CITY VARCHAR(25)
);

CREATE TABLE DEPOSIT (
    LOANNO VARCHAR(10) PRIMARY KEY,
    CNAME VARCHAR(25),
    BNAME VARCHAR(25),
    AMOUNT INT(10,2),
    FOREIGN KEY (CNAME) REFERENCES CUSTOMERS(CNAME),
    FOREIGN KEY (BNAME) REFERENCES BRANCH(BNAME)
);

CREATE TABLE BORROW (
    LOANNO VARCHAR(10) PRIMARY KEY,
    CNAME VARCHAR(25),
    BNAME VARCHAR(25),
    AMOUNT INT(10,2),
    FOREIGN KEY (CNAME) REFERENCES CUSTOMERS(CNAME),
    FOREIGN KEY (BNAME) REFERENCES BRANCH(BNAME)
);



INSERT INTO BRANCH (BNAME, CITY) VALUES
('SBT NEW DELHI', 'NEW DELHI'),
('SBT CALICUT', 'CALICUT'),
('HDFC BANGALORE', 'BANGALORE'),
('ICICI MUMBAI', 'MUMBAI'),
('AXIS CHENNAI', 'CHENNAI');

INSERT INTO CUSTOMERS (CNAME, CITY) VALUES
('RAHUL', 'CALICUT'),
('ANIL', 'MUMBAI'),
('SUNIL', 'CHENNAI'),
('RAJ', 'BANGALORE'),
('SURESH', 'NEW DELHI');

INSERT INTO DEPOSIT (LOANNO, CNAME, BNAME, AMOUNT) VALUES
('D1001', 'RAHUL', 'SBT NEW DELHI', 5000),
('D1002', 'ANIL', 'HDFC BANGALORE', 10000),
('D1003', 'SUNIL', 'ICICI MUMBAI', 7500),
('D1004', 'RAJ', 'AXIS CHENNAI', 20000),
('D1005', 'SURESH', 'SBT CALICUT', 15000);

INSERT INTO BORROW (LOANNO, CNAME, BNAME, AMOUNT) VALUES
('B2001', 'RAHUL', 'SBT CALICUT', 2500),
('B2002', 'ANIL', 'ICICI MUMBAI', 8000),
('B2003', 'SUNIL', 'AXIS CHENNAI', 6000),
('B2004', 'RAJ', 'HDFC BANGALORE', 12000),
('B2005', 'SURESH', 'SBT NEW DELHI', 10000);



SELECT C.CNAME
FROM CUSTOMERS C
JOIN DEPOSIT D ON C.CNAME = D.CNAME
WHERE C.CITY = 'CALICUT' AND D.BNAME = 'SBT NEW DELHI';

SELECT DISTINCT C.CNAME
FROM CUSTOMERS C
JOIN DEPOSIT D ON C.CNAME = D.CNAME
JOIN BRANCH B ON D.BNAME = B.BNAME
WHERE C.CITY = B.CITY;


SELECT DISTINCT C.CNAME
FROM CUSTOMERS C
JOIN BORROW B ON C.CNAME = B.CNAME
WHERE C.CITY = 'CALICUT';


SELECT DISTINCT C.CNAME
FROM CUSTOMERS C
JOIN DEPOSIT D ON C.CNAME = D.CNAME
JOIN BRANCH B ON D.BNAME = B.BNAME
WHERE B.CITY = (SELECT CITY FROM CUSTOMERS WHERE CNAME = 'ANIL');

SELECT DISTINCT C.CNAME
FROM CUSTOMERS C
JOIN BRANCH B ON C.CITY = B.CITY
WHERE B.BNAME = (SELECT BNAME FROM DEPOSIT WHERE CNAME = 'SUNIL');










